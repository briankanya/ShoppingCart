class Cart{constructor(t){this.taxRate=t,this.subtotal=0,this.products=[]}clear(){this.subtotal=0,this.products=[]}get total(){return this.calcTotal()}calcTotal(){return accounting.formatMoney(this.subtotal*(1+this.taxRate))}get numberOfProducts(){return this.countProducts()}countProducts(){return this.products.length}setProductQuantity(t,s){this.products[t]?s?this.products[t].quantity>s?(this.subtotal=this.subtotal-(this.products[t].quantity-s)*this.products[t].price,this.products[t].quantity=s):this.products[t].quantity<s&&(this.subtotal=this.subtotal+(s-this.products[t].quantity)*this.products[t].price,this.products[t].quantity=s):0===s?(this.subtotal=this.subtotal-this.products[t].quantity*this.products[t].price,this.products[t]=null):(this.subtotal=this.subtotal+this.products[t].price,this.products[t].quantity=this.products[t].quantity+1):(this.products[t]=flowers[t],this.subtotal=this.subtotal+flowers[t].price)}}
var availableFlowersTemplate='\n\t<div class="col-lg-4">\n\t\t<img class="img-thumbnail" src="%imageUrl%" alt="%description%">\n\t\t<p>%name%: %price%</p>\n\t\t<button onclick="cart.setProductQuantity(%index%)" type="button" class="btn btn-primary btn-sm btn-sm-block mx-auto">Add to Cart</button>\n\t</div>\n',cartItemsTemplate='\n\t<div class="row">\n\t\t<div class="col">\n\t\t\t<img class="img-thumbnail" src="%imageUrl%" alt="%description%">\n\t\t</div>\n\t\t<div class="col">\n\t\t\t%name% - %price%\n\t\t\t<input id="%index%" type="number" min="0" name="quantity" value="%quantity%">\n\t\t</div>\n\t</div>\n',cartTotalTemplate='\n\t<div class="row">\n\t\t<div class="col">\n\t\t\t<h2 id="cartTotal">Total: %total%</h2>\n\t\t</div>\n\t</div>\n',cart=new Cart(.075);function updateCartTotalHTML(){$("#cartTotal").length?$("#cartTotal").text("Total: "+cart.total):$("#cartItems").append(cartTotalTemplate.replace("%total%",cart.total))}function cartItemsHTML(t,a,e,r,n,c){var l=cartItemsTemplate.replace("%name%",t);return l=(l=(l=(l=(l=l.replace("%price%",accounting.formatMoney(a))).replace("%description%",e)).replace("%imageUrl%",r)).replace("%quantity%",n)).replace("%index%",c)}function availableFlowersHTML(t,a,e,r,n){var c=availableFlowersTemplate.replace("%name%",t);return c=(c=(c=(c=c.replace("%price%",accounting.formatMoney(a))).replace("%description%",e)).replace("%imageUrl%",r)).replace("%index%",n)}$(document).ready(function(){for(var t,a=0;a<flowers.length;a++)cart.products[a]=null,t=flowers[a],$("#flowers").append(availableFlowersHTML(t.name,t.price,t.description,t.imageUrl,a));$("#cartModal").on("show.bs.modal",function(a){$("#cartItems").empty();for(var e=0;e<cart.numberOfProducts;e++)cart.products[e]&&(t=cart.products[e],$("#cartItems").append(cartItemsHTML(t.name,t.price,t.description,t.imageUrl,t.quantity,e)));updateCartTotalHTML()}),$("#cartItems").on("change","input",function(){var t=parseInt($(this).attr("id")),a=parseInt($(this).val());cart.setProductQuantity(t,a),updateCartTotalHTML()})});
paypal.Button.render({env:"sandbox",commit:!0,style:{color:"gold",size:"responsive",shape:"rect",layout:"horizontal",fundingicons:"true"},client:{sandbox:"ATzHzenNN4bhjUaj-P8i9-hREBrtVL39S3Hcm8U3K6aqNTHOHzWAkoJ25qQmbeJ6wlhOWnY1ydbRXdJZ"},payment:function(t,e){return e.payment.create({payment:{transactions:[{amount:{total:""+accounting.parse(cart.total),currency:"USD"}}]}})},onAuthorize:function(t,e){return e.payment.execute().then(function(t){alert("Payment of flowers complete"),$("#cartModal").modal("hide"),cart.clear()})}},"#paypal-button");
class Product{constructor(i,e,r,a,t){this.name=i,this.price=e,this.quantity=r,this.description=a,this.imageUrl=t}}var flowers=[{name:"Aster",price:9.99,quantity:1,description:"An aster",imageUrl:"./img/flowers/aster.jpg"},{name:"Chrysanthemum",price:9.99,quantity:1,description:"A chrysanthemum",imageUrl:"./img/flowers/chrysanthemum.jpg"},{name:"Daisy",price:9.99,quantity:1,description:"A daisy",imageUrl:"./img/flowers/daisy.jpg"},{name:"Foxglove",price:9.99,quantity:1,description:"A foxglove",imageUrl:"./img/flowers/foxglove.jpg"},{name:"Lavender",price:9.99,quantity:1,description:"A lavender",imageUrl:"./img/flowers/lavender.jpg"},{name:"Muscari",price:9.99,quantity:1,description:"A muscari",imageUrl:"./img/flowers/muscari.jpg"},{name:"Rose",price:9.99,quantity:1,description:"A rose",imageUrl:"./img/flowers/rose.jpg"},{name:"Sunflower",price:9.99,quantity:1,description:"A sunflower",imageUrl:"./img/flowers/sunflower.jpg"},{name:"Tulip",price:9.99,quantity:1,description:"A tulip",imageUrl:"./img/flowers/tulip.jpg"}];